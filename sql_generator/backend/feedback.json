[
  {
    "query": "Show me active devices",
    "sql": "WITH nontest_user AS\n     (SELECT customer_id,\n             lower(username) AS username,\n             split(lower(username), '@')[2] AS user_email_domain\n      FROM \"ccs-aquila-louise-accountmanagement-customerusers\"\n      WHERE split(lower(username), '@')[2] NOT IN ('glcptest.com',\n                                                   'esc-std.glcpsoltest.net',\n                                                   'hpe.com',\n                                                   'hpe.hr',\n                                                   'hpecds.com',\n                                                   'hpedemos.com',\n                                                   'hpedemos.net',\n                                                   'hpedev.io',\n                                                   'hpelabsonline.com',\n                                                   'hpevlabs.net',\n                                                   'groups.ext.hpe.com',\n                                                   'merlin.test.glc.hpe.com',\n                                                   'recovery.auth.greenlake.hpe.com',\n                                                   'testhpe.com',\n                                                   'aruba-expert.com',\n                                                   'aruba-workbench.com',\n                                                   'aruba.flane.de',\n                                                   'arubademo.net',\n                                                   'arubanetworks.com',\n                                                   'arubatraininglabs.net',\n                                                   'arubaworkshops.net',\n                                                   'gmail.com',\n                                                   'yahoo.co.in',\n                                                   'yahoo.co.uk',\n                                                   'yahoo.com',\n                                                   'yahoo.com.mx',\n                                                   'outlook.com',\n                                                   'outlook.com.br',\n                                                   'outlook.dk',\n                                                   'outlook.es',\n                                                   'outlook.fr',\n                                                   'hotmail.co.uk',\n                                                   'hotmail.com',\n                                                   'hotmail.de',\n                                                   'hotmail.fr',\n                                                   '126.com') ),\n\nnontest_customer AS\n     (SELECT DISTINCT customer_id,\n                      'non Test Workspace' AS if_test_workspace\n      FROM nontest_user),\n\ndsdefinedacct AS\n     (SELECT c.customer_id AS platform_customer_id,\n             c.msp_id,\n             c.account_type,\n             c.account_status,\n             COALESCE(nc.if_test_workspace, 'Test Workspace') AS if_test_workspace\n      FROM \"ccs-aquila-louise-accountmanagement-customers\" c\n      LEFT JOIN nontest_customer nc ON c.customer_id = nc.customer_id\n      WHERE c.platform_customer_id = 'PLATFORM_ACCOUNT' ),\n\ncustomers_auth AS\n     (SELECT customer_id AS platform_customer_id,\n             CASE\n                 WHEN organization_id IS NULL THEN 'v1'\n                 ELSE 'v2'\n             END AS workspace_auth_version\n      FROM \"ccs-aquila-louise-accountmanagement-customers\"\n      WHERE platform_customer_id = 'PLATFORM_ACCOUNT' ),\n        \nactive_sub as\n     (select subscription_key, platform_customer_id\n      from \"ccs-aquila-tahoe-subscriptiondimension\"\n      where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n      \tand state_type = 'started'\n        and subscription_type != 'OPSRAMP'\n        and quantity < 10000000 ),\n\ndevice_sub_dim as\n\t(\n\t\tselect subscription_key, serial_number, application_id as app_id\n\t    from \"ccs-aquila-tahoe-devicesubscriptiondimension\"\n\t    where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n\t),\n\n sm_device as\n\t (\n\t \tselect serial_number, device_type\n\t \tfrom \"ccs-aquila-louise-subscriptionmanagement-smdevice\"\n\t ),\n\nactive_dev as\n     (select ca.workspace_auth_version,\n     \t     dda.if_test_workspace,\n             dsd.serial_number,\n             dda.account_type,\n             case\n                 when sd.device_type in ('STORAGE',\n                                        'DHCI_STORAGE') then 'Storage'\n                 when sd.device_type in ('COMPUTE') then 'Compute'\n                 when sd.device_type in ('ALS',\n                                        'AP',\n                                        'CONTROLLER',\n                                        'GATEWAY',\n                                        'IAP',\n                                        'SWITCH',\n                                        'SD_WAN_GW',\n                                        'BRIDGE') then 'Aruba'\n                 when sd.device_type in ('SENSOR') then 'UXI'\n                 else 'Others'\n             end as BU_device_type,\n             dsd.app_id,\n             case\n                 when dsd.app_id='683da368-66cb-4ee7-90a9-ec1964768092' then 'Aruba'\n                 when dsd.app_id='b394fa01-8858-4d73-8818-eadaf12eaf37' then 'Compute'\n                 when dsd.app_id='980eea3c-b063-451e-8a45-ebcaa54fd561' then 'Storage'\n                 when dsd.app_id='f4cc7322-f1c0-4546-a06c-74e0c3894769' then 'Opsramp'\n                 when dsd.app_id='7cc837db-2045-4d58-a16f-b167bb9fd0d2' then 'UXI'\n                 when dsd.app_id is null then 'missing'\n                 else 'Others'\n             end as application_name\n      from active_sub as1\n      inner join device_sub_dim dsd on dsd.subscription_key=as1.subscription_key\n      inner join sm_device sd on sd.serial_number = dsd.serial_number\n      left join dsdefinedacct dda on as1.platform_customer_id=dda.platform_customer_id\n      left join customers_auth ca on ca.platform_customer_id = dda.platform_customer_id)\nSELECT *\nFROM active_dev\nWHERE if_test_workspace = 'non Test Workspace'\nAND is_active = TRUE;",
    "rating": "Good",
    "timestamp": "2025-12-03T10:10:17.236155"
  },
  {
    "query": "Show me active devices",
    "sql": "WITH nontest_user AS\n     (SELECT customer_id,\n             lower(username) AS username,\n             split(lower(username), '@')[2] AS user_email_domain\n      FROM \"ccs-aquila-louise-accountmanagement-customerusers\"\n      WHERE split(lower(username), '@')[2] NOT IN ('glcptest.com',\n                                                   'esc-std.glcpsoltest.net',\n                                                   'hpe.com',\n                                                   'hpe.hr',\n                                                   'hpecds.com',\n                                                   'hpedemos.com',\n                                                   'hpedemos.net',\n                                                   'hpedev.io',\n                                                   'hpelabsonline.com',\n                                                   'hpevlabs.net',\n                                                   'groups.ext.hpe.com',\n                                                   'merlin.test.glc.hpe.com',\n                                                   'recovery.auth.greenlake.hpe.com',\n                                                   'testhpe.com',\n                                                   'aruba-expert.com',\n                                                   'aruba-workbench.com',\n                                                   'aruba.flane.de',\n                                                   'arubademo.net',\n                                                   'arubanetworks.com',\n                                                   'arubatraininglabs.net',\n                                                   'arubaworkshops.net',\n                                                   'gmail.com',\n                                                   'yahoo.co.in',\n                                                   'yahoo.co.uk',\n                                                   'yahoo.com',\n                                                   'yahoo.com.mx',\n                                                   'outlook.com',\n                                                   'outlook.com.br',\n                                                   'outlook.dk',\n                                                   'outlook.es',\n                                                   'outlook.fr',\n                                                   'hotmail.co.uk',\n                                                   'hotmail.com',\n                                                   'hotmail.de',\n                                                   'hotmail.fr',\n                                                   '126.com') ),\n\nnontest_customer AS\n     (SELECT DISTINCT customer_id,\n                      'non Test Workspace' AS if_test_workspace\n      FROM nontest_user),\n\ndsdefinedacct AS\n     (SELECT c.customer_id AS platform_customer_id,\n             c.msp_id,\n             c.account_type,\n             c.account_status,\n             COALESCE(nc.if_test_workspace, 'Test Workspace') AS if_test_workspace\n      FROM \"ccs-aquila-louise-accountmanagement-customers\" c\n      LEFT JOIN nontest_customer nc ON c.customer_id = nc.customer_id\n      WHERE c.platform_customer_id = 'PLATFORM_ACCOUNT' ),\n\ncustomers_auth AS\n     (SELECT customer_id AS platform_customer_id,\n             CASE\n                 WHEN organization_id IS NULL THEN 'v1'\n                 ELSE 'v2'\n             END AS workspace_auth_version\n      FROM \"ccs-aquila-louise-accountmanagement-customers\"\n      WHERE platform_customer_id = 'PLATFORM_ACCOUNT' ),\n        \nactive_sub as\n     (select subscription_key, platform_customer_id\n      from \"ccs-aquila-tahoe-subscriptiondimension\"\n      where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n      \tand state_type = 'started'\n        and subscription_type != 'OPSRAMP'\n        and quantity < 10000000 ),\n\ndevice_sub_dim as\n\t(\n\t\tselect subscription_key, serial_number, application_id as app_id\n\t    from \"ccs-aquila-tahoe-devicesubscriptiondimension\"\n\t    where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n\t),\n\n sm_device as\n\t (\n\t \tselect serial_number, device_type\n\t \tfrom \"ccs-aquila-louise-subscriptionmanagement-smdevice\"\n\t ),\n\nactive_dev as\n     (select ca.workspace_auth_version,\n     \t     dda.if_test_workspace,\n             dsd.serial_number,\n             dda.account_type,\n             case\n                 when sd.device_type in ('STORAGE',\n                                        'DHCI_STORAGE') then 'Storage'\n                 when sd.device_type in ('COMPUTE') then 'Compute'\n                 when sd.device_type in ('ALS',\n                                        'AP',\n                                        'CONTROLLER',\n                                        'GATEWAY',\n                                        'IAP',\n                                        'SWITCH',\n                                        'SD_WAN_GW',\n                                        'BRIDGE') then 'Aruba'\n                 when sd.device_type in ('SENSOR') then 'UXI'\n                 else 'Others'\n             end as BU_device_type,\n             dsd.app_id,\n             case\n                 when dsd.app_id='683da368-66cb-4ee7-90a9-ec1964768092' then 'Aruba'\n                 when dsd.app_id='b394fa01-8858-4d73-8818-eadaf12eaf37' then 'Compute'\n                 when dsd.app_id='980eea3c-b063-451e-8a45-ebcaa54fd561' then 'Storage'\n                 when dsd.app_id='f4cc7322-f1c0-4546-a06c-74e0c3894769' then 'Opsramp'\n                 when dsd.app_id='7cc837db-2045-4d58-a16f-b167bb9fd0d2' then 'UXI'\n                 when dsd.app_id is null then 'missing'\n                 else 'Others'\n             end as application_name\n      from active_sub as1\n      inner join device_sub_dim dsd on dsd.subscription_key=as1.subscription_key\n      inner join sm_device sd on sd.serial_number = dsd.serial_number\n      left join dsdefinedacct dda on as1.platform_customer_id=dda.platform_customer_id\n      left join customers_auth ca on ca.platform_customer_id = dda.platform_customer_id)\nSELECT *\nFROM active_dev\nWHERE if_test_workspace = 'non Test Workspace'\nAND is_active = TRUE;",
    "rating": "Good",
    "timestamp": "2025-12-03T10:10:25.868820"
  },
  {
    "query": "Show me active devices",
    "sql": "WITH nontest_user AS\n     (SELECT customer_id,\n             lower(username) AS username,\n             split(lower(username), '@')[2] AS user_email_domain\n      FROM \"ccs-aquila-louise-accountmanagement-customerusers\"\n      WHERE split(lower(username), '@')[2] NOT IN ('glcptest.com',\n                                                   'esc-std.glcpsoltest.net',\n                                                   'hpe.com',\n                                                   'hpe.hr',\n                                                   'hpecds.com',\n                                                   'hpedemos.com',\n                                                   'hpedemos.net',\n                                                   'hpedev.io',\n                                                   'hpelabsonline.com',\n                                                   'hpevlabs.net',\n                                                   'groups.ext.hpe.com',\n                                                   'merlin.test.glc.hpe.com',\n                                                   'recovery.auth.greenlake.hpe.com',\n                                                   'testhpe.com',\n                                                   'aruba-expert.com',\n                                                   'aruba-workbench.com',\n                                                   'aruba.flane.de',\n                                                   'arubademo.net',\n                                                   'arubanetworks.com',\n                                                   'arubatraininglabs.net',\n                                                   'arubaworkshops.net',\n                                                   'gmail.com',\n                                                   'yahoo.co.in',\n                                                   'yahoo.co.uk',\n                                                   'yahoo.com',\n                                                   'yahoo.com.mx',\n                                                   'outlook.com',\n                                                   'outlook.com.br',\n                                                   'outlook.dk',\n                                                   'outlook.es',\n                                                   'outlook.fr',\n                                                   'hotmail.co.uk',\n                                                   'hotmail.com',\n                                                   'hotmail.de',\n                                                   'hotmail.fr',\n                                                   '126.com') ),\n\nnontest_customer AS\n     (SELECT DISTINCT customer_id,\n                      'non Test Workspace' AS if_test_workspace\n      FROM nontest_user),\n\ndsdefinedacct AS\n     (SELECT c.customer_id AS platform_customer_id,\n             c.msp_id,\n             c.account_type,\n             c.account_status,\n             COALESCE(nc.if_test_workspace, 'Test Workspace') AS if_test_workspace\n      FROM \"ccs-aquila-louise-accountmanagement-customers\" c\n      LEFT JOIN nontest_customer nc ON c.customer_id = nc.customer_id\n      WHERE c.platform_customer_id = 'PLATFORM_ACCOUNT' ),\n\ncustomers_auth AS\n     (SELECT customer_id AS platform_customer_id,\n             CASE\n                 WHEN organization_id IS NULL THEN 'v1'\n                 ELSE 'v2'\n             END AS workspace_auth_version\n      FROM \"ccs-aquila-louise-accountmanagement-customers\"\n      WHERE platform_customer_id = 'PLATFORM_ACCOUNT' ),\n        \nactive_sub as\n     (select subscription_key, platform_customer_id\n      from \"ccs-aquila-tahoe-subscriptiondimension\"\n      where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n      \tand state_type = 'started'\n        and subscription_type != 'OPSRAMP'\n        and quantity < 10000000 ),\n\ndevice_sub_dim as\n\t(\n\t\tselect subscription_key, serial_number, application_id as app_id\n\t    from \"ccs-aquila-tahoe-devicesubscriptiondimension\"\n\t    where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n\t),\n\n sm_device as\n\t (\n\t \tselect serial_number, device_type\n\t \tfrom \"ccs-aquila-louise-subscriptionmanagement-smdevice\"\n\t ),\n\nactive_dev as\n     (select ca.workspace_auth_version,\n     \t     dda.if_test_workspace,\n             dsd.serial_number,\n             dda.account_type,\n             case\n                 when sd.device_type in ('STORAGE',\n                                        'DHCI_STORAGE') then 'Storage'\n                 when sd.device_type in ('COMPUTE') then 'Compute'\n                 when sd.device_type in ('ALS',\n                                        'AP',\n                                        'CONTROLLER',\n                                        'GATEWAY',\n                                        'IAP',\n                                        'SWITCH',\n                                        'SD_WAN_GW',\n                                        'BRIDGE') then 'Aruba'\n                 when sd.device_type in ('SENSOR') then 'UXI'\n                 else 'Others'\n             end as BU_device_type,\n             dsd.app_id,\n             case\n                 when dsd.app_id='683da368-66cb-4ee7-90a9-ec1964768092' then 'Aruba'\n                 when dsd.app_id='b394fa01-8858-4d73-8818-eadaf12eaf37' then 'Compute'\n                 when dsd.app_id='980eea3c-b063-451e-8a45-ebcaa54fd561' then 'Storage'\n                 when dsd.app_id='f4cc7322-f1c0-4546-a06c-74e0c3894769' then 'Opsramp'\n                 when dsd.app_id='7cc837db-2045-4d58-a16f-b167bb9fd0d2' then 'UXI'\n                 when dsd.app_id is null then 'missing'\n                 else 'Others'\n             end as application_name\n      from active_sub as1\n      inner join device_sub_dim dsd on dsd.subscription_key=as1.subscription_key\n      inner join sm_device sd on sd.serial_number = dsd.serial_number\n      left join dsdefinedacct dda on as1.platform_customer_id=dda.platform_customer_id\n      left join customers_auth ca on ca.platform_customer_id = dda.platform_customer_id)\nSELECT *\nFROM active_dev\nWHERE if_test_workspace = 'non Test Workspace'\nAND is_active = TRUE;",
    "rating": "Good",
    "timestamp": "2025-12-03T10:10:26.438940"
  },
  {
    "query": "Show me active devices",
    "sql": "WITH nontest_user AS\n     (SELECT customer_id,\n             lower(username) AS username,\n             split(lower(username), '@')[2] AS user_email_domain\n      FROM \"ccs-aquila-louise-accountmanagement-customerusers\"\n      WHERE split(lower(username), '@')[2] NOT IN ('glcptest.com',\n                                                   'esc-std.glcpsoltest.net',\n                                                   'hpe.com',\n                                                   'hpe.hr',\n                                                   'hpecds.com',\n                                                   'hpedemos.com',\n                                                   'hpedemos.net',\n                                                   'hpedev.io',\n                                                   'hpelabsonline.com',\n                                                   'hpevlabs.net',\n                                                   'groups.ext.hpe.com',\n                                                   'merlin.test.glc.hpe.com',\n                                                   'recovery.auth.greenlake.hpe.com',\n                                                   'testhpe.com',\n                                                   'aruba-expert.com',\n                                                   'aruba-workbench.com',\n                                                   'aruba.flane.de',\n                                                   'arubademo.net',\n                                                   'arubanetworks.com',\n                                                   'arubatraininglabs.net',\n                                                   'arubaworkshops.net',\n                                                   'gmail.com',\n                                                   'yahoo.co.in',\n                                                   'yahoo.co.uk',\n                                                   'yahoo.com',\n                                                   'yahoo.com.mx',\n                                                   'outlook.com',\n                                                   'outlook.com.br',\n                                                   'outlook.dk',\n                                                   'outlook.es',\n                                                   'outlook.fr',\n                                                   'hotmail.co.uk',\n                                                   'hotmail.com',\n                                                   'hotmail.de',\n                                                   'hotmail.fr',\n                                                   '126.com') ),\n\nnontest_customer AS\n     (SELECT DISTINCT customer_id,\n                      'non Test Workspace' AS if_test_workspace\n      FROM nontest_user),\n\ndsdefinedacct AS\n     (SELECT c.customer_id AS platform_customer_id,\n             c.msp_id,\n             c.account_type,\n             c.account_status,\n             COALESCE(nc.if_test_workspace, 'Test Workspace') AS if_test_workspace\n      FROM \"ccs-aquila-louise-accountmanagement-customers\" c\n      LEFT JOIN nontest_customer nc ON c.customer_id = nc.customer_id\n      WHERE c.platform_customer_id = 'PLATFORM_ACCOUNT' ),\n\ncustomers_auth AS\n     (SELECT customer_id AS platform_customer_id,\n             CASE\n                 WHEN organization_id IS NULL THEN 'v1'\n                 ELSE 'v2'\n             END AS workspace_auth_version\n      FROM \"ccs-aquila-louise-accountmanagement-customers\"\n      WHERE platform_customer_id = 'PLATFORM_ACCOUNT' ),\n        \nactive_sub as\n     (select subscription_key, platform_customer_id\n      from \"ccs-aquila-tahoe-subscriptiondimension\"\n      where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n      \tand state_type = 'started'\n        and subscription_type != 'OPSRAMP'\n        and quantity < 10000000 ),\n\ndevice_sub_dim as\n\t(\n\t\tselect subscription_key, serial_number, application_id as app_id\n\t    from \"ccs-aquila-tahoe-devicesubscriptiondimension\"\n\t    where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n\t),\n\n sm_device as\n\t (\n\t \tselect serial_number, device_type\n\t \tfrom \"ccs-aquila-louise-subscriptionmanagement-smdevice\"\n\t ),\n\nactive_dev as\n     (select ca.workspace_auth_version,\n     \t     dda.if_test_workspace,\n             dsd.serial_number,\n             dda.account_type,\n             case\n                 when sd.device_type in ('STORAGE',\n                                        'DHCI_STORAGE') then 'Storage'\n                 when sd.device_type in ('COMPUTE') then 'Compute'\n                 when sd.device_type in ('ALS',\n                                        'AP',\n                                        'CONTROLLER',\n                                        'GATEWAY',\n                                        'IAP',\n                                        'SWITCH',\n                                        'SD_WAN_GW',\n                                        'BRIDGE') then 'Aruba'\n                 when sd.device_type in ('SENSOR') then 'UXI'\n                 else 'Others'\n             end as BU_device_type,\n             dsd.app_id,\n             case\n                 when dsd.app_id='683da368-66cb-4ee7-90a9-ec1964768092' then 'Aruba'\n                 when dsd.app_id='b394fa01-8858-4d73-8818-eadaf12eaf37' then 'Compute'\n                 when dsd.app_id='980eea3c-b063-451e-8a45-ebcaa54fd561' then 'Storage'\n                 when dsd.app_id='f4cc7322-f1c0-4546-a06c-74e0c3894769' then 'Opsramp'\n                 when dsd.app_id='7cc837db-2045-4d58-a16f-b167bb9fd0d2' then 'UXI'\n                 when dsd.app_id is null then 'missing'\n                 else 'Others'\n             end as application_name\n      from active_sub as1\n      inner join device_sub_dim dsd on dsd.subscription_key=as1.subscription_key\n      inner join sm_device sd on sd.serial_number = dsd.serial_number\n      left join dsdefinedacct dda on as1.platform_customer_id=dda.platform_customer_id\n      left join customers_auth ca on ca.platform_customer_id = dda.platform_customer_id)\nSELECT *\nFROM active_dev\nWHERE if_test_workspace = 'non Test Workspace'\nAND is_active = TRUE;",
    "rating": "Good",
    "timestamp": "2025-12-03T10:10:26.847205"
  },
  {
    "query": "Show me active devices",
    "sql": "WITH nontest_user AS\n     (SELECT customer_id,\n             lower(username) AS username,\n             split(lower(username), '@')[2] AS user_email_domain\n      FROM \"ccs-aquila-louise-accountmanagement-customerusers\"\n      WHERE split(lower(username), '@')[2] NOT IN ('glcptest.com',\n                                                   'esc-std.glcpsoltest.net',\n                                                   'hpe.com',\n                                                   'hpe.hr',\n                                                   'hpecds.com',\n                                                   'hpedemos.com',\n                                                   'hpedemos.net',\n                                                   'hpedev.io',\n                                                   'hpelabsonline.com',\n                                                   'hpevlabs.net',\n                                                   'groups.ext.hpe.com',\n                                                   'merlin.test.glc.hpe.com',\n                                                   'recovery.auth.greenlake.hpe.com',\n                                                   'testhpe.com',\n                                                   'aruba-expert.com',\n                                                   'aruba-workbench.com',\n                                                   'aruba.flane.de',\n                                                   'arubademo.net',\n                                                   'arubanetworks.com',\n                                                   'arubatraininglabs.net',\n                                                   'arubaworkshops.net',\n                                                   'gmail.com',\n                                                   'yahoo.co.in',\n                                                   'yahoo.co.uk',\n                                                   'yahoo.com',\n                                                   'yahoo.com.mx',\n                                                   'outlook.com',\n                                                   'outlook.com.br',\n                                                   'outlook.dk',\n                                                   'outlook.es',\n                                                   'outlook.fr',\n                                                   'hotmail.co.uk',\n                                                   'hotmail.com',\n                                                   'hotmail.de',\n                                                   'hotmail.fr',\n                                                   '126.com') ),\n\nnontest_customer AS\n     (SELECT DISTINCT customer_id,\n                      'non Test Workspace' AS if_test_workspace\n      FROM nontest_user),\n\ndsdefinedacct AS\n     (SELECT c.customer_id AS platform_customer_id,\n             c.msp_id,\n             c.account_type,\n             c.account_status,\n             COALESCE(nc.if_test_workspace, 'Test Workspace') AS if_test_workspace\n      FROM \"ccs-aquila-louise-accountmanagement-customers\" c\n      LEFT JOIN nontest_customer nc ON c.customer_id = nc.customer_id\n      WHERE c.platform_customer_id = 'PLATFORM_ACCOUNT' ),\n\ncustomers_auth AS\n     (SELECT customer_id AS platform_customer_id,\n             CASE\n                 WHEN organization_id IS NULL THEN 'v1'\n                 ELSE 'v2'\n             END AS workspace_auth_version\n      FROM \"ccs-aquila-louise-accountmanagement-customers\"\n      WHERE platform_customer_id = 'PLATFORM_ACCOUNT' ),\n        \nactive_sub as\n     (select subscription_key, platform_customer_id\n      from \"ccs-aquila-tahoe-subscriptiondimension\"\n      where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n      \tand state_type = 'started'\n        and subscription_type != 'OPSRAMP'\n        and quantity < 10000000 ),\n\ndevice_sub_dim as\n\t(\n\t\tselect subscription_key, serial_number, application_id as app_id\n\t    from \"ccs-aquila-tahoe-devicesubscriptiondimension\"\n\t    where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n\t),\n\n sm_device as\n\t (\n\t \tselect serial_number, device_type\n\t \tfrom \"ccs-aquila-louise-subscriptionmanagement-smdevice\"\n\t ),\n\nactive_dev as\n     (select ca.workspace_auth_version,\n     \t     dda.if_test_workspace,\n             dsd.serial_number,\n             dda.account_type,\n             case\n                 when sd.device_type in ('STORAGE',\n                                        'DHCI_STORAGE') then 'Storage'\n                 when sd.device_type in ('COMPUTE') then 'Compute'\n                 when sd.device_type in ('ALS',\n                                        'AP',\n                                        'CONTROLLER',\n                                        'GATEWAY',\n                                        'IAP',\n                                        'SWITCH',\n                                        'SD_WAN_GW',\n                                        'BRIDGE') then 'Aruba'\n                 when sd.device_type in ('SENSOR') then 'UXI'\n                 else 'Others'\n             end as BU_device_type,\n             dsd.app_id,\n             case\n                 when dsd.app_id='683da368-66cb-4ee7-90a9-ec1964768092' then 'Aruba'\n                 when dsd.app_id='b394fa01-8858-4d73-8818-eadaf12eaf37' then 'Compute'\n                 when dsd.app_id='980eea3c-b063-451e-8a45-ebcaa54fd561' then 'Storage'\n                 when dsd.app_id='f4cc7322-f1c0-4546-a06c-74e0c3894769' then 'Opsramp'\n                 when dsd.app_id='7cc837db-2045-4d58-a16f-b167bb9fd0d2' then 'UXI'\n                 when dsd.app_id is null then 'missing'\n                 else 'Others'\n             end as application_name\n      from active_sub as1\n      inner join device_sub_dim dsd on dsd.subscription_key=as1.subscription_key\n      inner join sm_device sd on sd.serial_number = dsd.serial_number\n      left join dsdefinedacct dda on as1.platform_customer_id=dda.platform_customer_id\n      left join customers_auth ca on ca.platform_customer_id = dda.platform_customer_id)\nSELECT *\nFROM active_dev\nWHERE if_test_workspace = 'non Test Workspace'\nAND is_active = TRUE;",
    "rating": "Good",
    "timestamp": "2025-12-03T10:10:27.271954"
  },
  {
    "query": "Show me active devices",
    "sql": "WITH nontest_user AS\n     (SELECT customer_id,\n             lower(username) AS username,\n             split(lower(username), '@')[2] AS user_email_domain\n      FROM \"ccs-aquila-louise-accountmanagement-customerusers\"\n      WHERE split(lower(username), '@')[2] NOT IN ('glcptest.com',\n                                                   'esc-std.glcpsoltest.net',\n                                                   'hpe.com',\n                                                   'hpe.hr',\n                                                   'hpecds.com',\n                                                   'hpedemos.com',\n                                                   'hpedemos.net',\n                                                   'hpedev.io',\n                                                   'hpelabsonline.com',\n                                                   'hpevlabs.net',\n                                                   'groups.ext.hpe.com',\n                                                   'merlin.test.glc.hpe.com',\n                                                   'recovery.auth.greenlake.hpe.com',\n                                                   'testhpe.com',\n                                                   'aruba-expert.com',\n                                                   'aruba-workbench.com',\n                                                   'aruba.flane.de',\n                                                   'arubademo.net',\n                                                   'arubanetworks.com',\n                                                   'arubatraininglabs.net',\n                                                   'arubaworkshops.net',\n                                                   'gmail.com',\n                                                   'yahoo.co.in',\n                                                   'yahoo.co.uk',\n                                                   'yahoo.com',\n                                                   'yahoo.com.mx',\n                                                   'outlook.com',\n                                                   'outlook.com.br',\n                                                   'outlook.dk',\n                                                   'outlook.es',\n                                                   'outlook.fr',\n                                                   'hotmail.co.uk',\n                                                   'hotmail.com',\n                                                   'hotmail.de',\n                                                   'hotmail.fr',\n                                                   '126.com') ),\n\nnontest_customer AS\n     (SELECT DISTINCT customer_id,\n                      'non Test Workspace' AS if_test_workspace\n      FROM nontest_user),\n\ndsdefinedacct AS\n     (SELECT c.customer_id AS platform_customer_id,\n             c.msp_id,\n             c.account_type,\n             c.account_status,\n             COALESCE(nc.if_test_workspace, 'Test Workspace') AS if_test_workspace\n      FROM \"ccs-aquila-louise-accountmanagement-customers\" c\n      LEFT JOIN nontest_customer nc ON c.customer_id = nc.customer_id\n      WHERE c.platform_customer_id = 'PLATFORM_ACCOUNT' ),\n\ncustomers_auth AS\n     (SELECT customer_id AS platform_customer_id,\n             CASE\n                 WHEN organization_id IS NULL THEN 'v1'\n                 ELSE 'v2'\n             END AS workspace_auth_version\n      FROM \"ccs-aquila-louise-accountmanagement-customers\"\n      WHERE platform_customer_id = 'PLATFORM_ACCOUNT' ),\n        \nactive_sub as\n     (select subscription_key, platform_customer_id\n      from \"ccs-aquila-tahoe-subscriptiondimension\"\n      where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n      \tand state_type = 'started'\n        and subscription_type != 'OPSRAMP'\n        and quantity < 10000000 ),\n\ndevice_sub_dim as\n\t(\n\t\tselect subscription_key, serial_number, application_id as app_id\n\t    from \"ccs-aquila-tahoe-devicesubscriptiondimension\"\n\t    where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n\t),\n\n sm_device as\n\t (\n\t \tselect serial_number, device_type\n\t \tfrom \"ccs-aquila-louise-subscriptionmanagement-smdevice\"\n\t ),\n\nactive_dev as\n     (select ca.workspace_auth_version,\n     \t     dda.if_test_workspace,\n             dsd.serial_number,\n             dda.account_type,\n             case\n                 when sd.device_type in ('STORAGE',\n                                        'DHCI_STORAGE') then 'Storage'\n                 when sd.device_type in ('COMPUTE') then 'Compute'\n                 when sd.device_type in ('ALS',\n                                        'AP',\n                                        'CONTROLLER',\n                                        'GATEWAY',\n                                        'IAP',\n                                        'SWITCH',\n                                        'SD_WAN_GW',\n                                        'BRIDGE') then 'Aruba'\n                 when sd.device_type in ('SENSOR') then 'UXI'\n                 else 'Others'\n             end as BU_device_type,\n             dsd.app_id,\n             case\n                 when dsd.app_id='683da368-66cb-4ee7-90a9-ec1964768092' then 'Aruba'\n                 when dsd.app_id='b394fa01-8858-4d73-8818-eadaf12eaf37' then 'Compute'\n                 when dsd.app_id='980eea3c-b063-451e-8a45-ebcaa54fd561' then 'Storage'\n                 when dsd.app_id='f4cc7322-f1c0-4546-a06c-74e0c3894769' then 'Opsramp'\n                 when dsd.app_id='7cc837db-2045-4d58-a16f-b167bb9fd0d2' then 'UXI'\n                 when dsd.app_id is null then 'missing'\n                 else 'Others'\n             end as application_name\n      from active_sub as1\n      inner join device_sub_dim dsd on dsd.subscription_key=as1.subscription_key\n      inner join sm_device sd on sd.serial_number = dsd.serial_number\n      left join dsdefinedacct dda on as1.platform_customer_id=dda.platform_customer_id\n      left join customers_auth ca on ca.platform_customer_id = dda.platform_customer_id)\nSELECT *\nFROM active_dev\nWHERE if_test_workspace = 'non Test Workspace'\nAND is_active = TRUE;",
    "rating": "Bad",
    "timestamp": "2025-12-03T10:10:28.592792"
  },
  {
    "query": "Show me active devices",
    "sql": "WITH nontest_user AS\n     (SELECT customer_id,\n             lower(username) AS username,\n             split(lower(username), '@')[2] AS user_email_domain\n      FROM \"ccs-aquila-louise-accountmanagement-customerusers\"\n      WHERE split(lower(username), '@')[2] NOT IN ('glcptest.com',\n                                                   'esc-std.glcpsoltest.net',\n                                                   'hpe.com',\n                                                   'hpe.hr',\n                                                   'hpecds.com',\n                                                   'hpedemos.com',\n                                                   'hpedemos.net',\n                                                   'hpedev.io',\n                                                   'hpelabsonline.com',\n                                                   'hpevlabs.net',\n                                                   'groups.ext.hpe.com',\n                                                   'merlin.test.glc.hpe.com',\n                                                   'recovery.auth.greenlake.hpe.com',\n                                                   'testhpe.com',\n                                                   'aruba-expert.com',\n                                                   'aruba-workbench.com',\n                                                   'aruba.flane.de',\n                                                   'arubademo.net',\n                                                   'arubanetworks.com',\n                                                   'arubatraininglabs.net',\n                                                   'arubaworkshops.net',\n                                                   'gmail.com',\n                                                   'yahoo.co.in',\n                                                   'yahoo.co.uk',\n                                                   'yahoo.com',\n                                                   'yahoo.com.mx',\n                                                   'outlook.com',\n                                                   'outlook.com.br',\n                                                   'outlook.dk',\n                                                   'outlook.es',\n                                                   'outlook.fr',\n                                                   'hotmail.co.uk',\n                                                   'hotmail.com',\n                                                   'hotmail.de',\n                                                   'hotmail.fr',\n                                                   '126.com') ),\n\nnontest_customer AS\n     (SELECT DISTINCT customer_id,\n                      'non Test Workspace' AS if_test_workspace\n      FROM nontest_user),\n\ndsdefinedacct AS\n     (SELECT c.customer_id AS platform_customer_id,\n             c.msp_id,\n             c.account_type,\n             c.account_status,\n             COALESCE(nc.if_test_workspace, 'Test Workspace') AS if_test_workspace\n      FROM \"ccs-aquila-louise-accountmanagement-customers\" c\n      LEFT JOIN nontest_customer nc ON c.customer_id = nc.customer_id\n      WHERE c.platform_customer_id = 'PLATFORM_ACCOUNT' ),\n\ncustomers_auth AS\n     (SELECT customer_id AS platform_customer_id,\n             CASE\n                 WHEN organization_id IS NULL THEN 'v1'\n                 ELSE 'v2'\n             END AS workspace_auth_version\n      FROM \"ccs-aquila-louise-accountmanagement-customers\"\n      WHERE platform_customer_id = 'PLATFORM_ACCOUNT' ),\n        \nactive_sub as\n     (select subscription_key, platform_customer_id\n      from \"ccs-aquila-tahoe-subscriptiondimension\"\n      where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n      \tand state_type = 'started'\n        and subscription_type != 'OPSRAMP'\n        and quantity < 10000000 ),\n\ndevice_sub_dim as\n\t(\n\t\tselect subscription_key, serial_number, application_id as app_id\n\t    from \"ccs-aquila-tahoe-devicesubscriptiondimension\"\n\t    where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n\t),\n\n sm_device as\n\t (\n\t \tselect serial_number, device_type\n\t \tfrom \"ccs-aquila-louise-subscriptionmanagement-smdevice\"\n\t ),\n\nactive_dev as\n     (select ca.workspace_auth_version,\n     \t     dda.if_test_workspace,\n             dsd.serial_number,\n             dda.account_type,\n             case\n                 when sd.device_type in ('STORAGE',\n                                        'DHCI_STORAGE') then 'Storage'\n                 when sd.device_type in ('COMPUTE') then 'Compute'\n                 when sd.device_type in ('ALS',\n                                        'AP',\n                                        'CONTROLLER',\n                                        'GATEWAY',\n                                        'IAP',\n                                        'SWITCH',\n                                        'SD_WAN_GW',\n                                        'BRIDGE') then 'Aruba'\n                 when sd.device_type in ('SENSOR') then 'UXI'\n                 else 'Others'\n             end as BU_device_type,\n             dsd.app_id,\n             case\n                 when dsd.app_id='683da368-66cb-4ee7-90a9-ec1964768092' then 'Aruba'\n                 when dsd.app_id='b394fa01-8858-4d73-8818-eadaf12eaf37' then 'Compute'\n                 when dsd.app_id='980eea3c-b063-451e-8a45-ebcaa54fd561' then 'Storage'\n                 when dsd.app_id='f4cc7322-f1c0-4546-a06c-74e0c3894769' then 'Opsramp'\n                 when dsd.app_id='7cc837db-2045-4d58-a16f-b167bb9fd0d2' then 'UXI'\n                 when dsd.app_id is null then 'missing'\n                 else 'Others'\n             end as application_name\n      from active_sub as1\n      inner join device_sub_dim dsd on dsd.subscription_key=as1.subscription_key\n      inner join sm_device sd on sd.serial_number = dsd.serial_number\n      left join dsdefinedacct dda on as1.platform_customer_id=dda.platform_customer_id\n      left join customers_auth ca on ca.platform_customer_id = dda.platform_customer_id)\nSELECT *\nFROM active_dev\nWHERE if_test_workspace = 'non Test Workspace'\nAND is_active = TRUE;",
    "rating": "Bad",
    "timestamp": "2025-12-03T10:10:29.659825"
  },
  {
    "query": "Show me active devices",
    "sql": "WITH nontest_user AS\n     (SELECT customer_id,\n             lower(username) AS username,\n             split(lower(username), '@')[2] AS user_email_domain\n      FROM \"ccs-aquila-louise-accountmanagement-customerusers\"\n      WHERE split(lower(username), '@')[2] NOT IN ('glcptest.com',\n                                                   'esc-std.glcpsoltest.net',\n                                                   'hpe.com',\n                                                   'hpe.hr',\n                                                   'hpecds.com',\n                                                   'hpedemos.com',\n                                                   'hpedemos.net',\n                                                   'hpedev.io',\n                                                   'hpelabsonline.com',\n                                                   'hpevlabs.net',\n                                                   'groups.ext.hpe.com',\n                                                   'merlin.test.glc.hpe.com',\n                                                   'recovery.auth.greenlake.hpe.com',\n                                                   'testhpe.com',\n                                                   'aruba-expert.com',\n                                                   'aruba-workbench.com',\n                                                   'aruba.flane.de',\n                                                   'arubademo.net',\n                                                   'arubanetworks.com',\n                                                   'arubatraininglabs.net',\n                                                   'arubaworkshops.net',\n                                                   'gmail.com',\n                                                   'yahoo.co.in',\n                                                   'yahoo.co.uk',\n                                                   'yahoo.com',\n                                                   'yahoo.com.mx',\n                                                   'outlook.com',\n                                                   'outlook.com.br',\n                                                   'outlook.dk',\n                                                   'outlook.es',\n                                                   'outlook.fr',\n                                                   'hotmail.co.uk',\n                                                   'hotmail.com',\n                                                   'hotmail.de',\n                                                   'hotmail.fr',\n                                                   '126.com') ),\n\nnontest_customer AS\n     (SELECT DISTINCT customer_id,\n                      'non Test Workspace' AS if_test_workspace\n      FROM nontest_user),\n\ndsdefinedacct AS\n     (SELECT c.customer_id AS platform_customer_id,\n             c.msp_id,\n             c.account_type,\n             c.account_status,\n             COALESCE(nc.if_test_workspace, 'Test Workspace') AS if_test_workspace\n      FROM \"ccs-aquila-louise-accountmanagement-customers\" c\n      LEFT JOIN nontest_customer nc ON c.customer_id = nc.customer_id\n      WHERE c.platform_customer_id = 'PLATFORM_ACCOUNT' ),\n\ncustomers_auth AS\n     (SELECT customer_id AS platform_customer_id,\n             CASE\n                 WHEN organization_id IS NULL THEN 'v1'\n                 ELSE 'v2'\n             END AS workspace_auth_version\n      FROM \"ccs-aquila-louise-accountmanagement-customers\"\n      WHERE platform_customer_id = 'PLATFORM_ACCOUNT' ),\n        \nactive_sub as\n     (select subscription_key, platform_customer_id\n      from \"ccs-aquila-tahoe-subscriptiondimension\"\n      where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n      \tand state_type = 'started'\n        and subscription_type != 'OPSRAMP'\n        and quantity < 10000000 ),\n\ndevice_sub_dim as\n\t(\n\t\tselect subscription_key, serial_number, application_id as app_id\n\t    from \"ccs-aquila-tahoe-devicesubscriptiondimension\"\n\t    where partition_date = FORMAT_DATETIME(CURRENT_DATE - INTERVAL '1' DAY, 'yyyy-MM-dd')\n\t),\n\n sm_device as\n\t (\n\t \tselect serial_number, device_type\n\t \tfrom \"ccs-aquila-louise-subscriptionmanagement-smdevice\"\n\t ),\n\nactive_dev as\n     (select ca.workspace_auth_version,\n     \t     dda.if_test_workspace,\n             dsd.serial_number,\n             dda.account_type,\n             case\n                 when sd.device_type in ('STORAGE',\n                                        'DHCI_STORAGE') then 'Storage'\n                 when sd.device_type in ('COMPUTE') then 'Compute'\n                 when sd.device_type in ('ALS',\n                                        'AP',\n                                        'CONTROLLER',\n                                        'GATEWAY',\n                                        'IAP',\n                                        'SWITCH',\n                                        'SD_WAN_GW',\n                                        'BRIDGE') then 'Aruba'\n                 when sd.device_type in ('SENSOR') then 'UXI'\n                 else 'Others'\n             end as BU_device_type,\n             dsd.app_id,\n             case\n                 when dsd.app_id='683da368-66cb-4ee7-90a9-ec1964768092' then 'Aruba'\n                 when dsd.app_id='b394fa01-8858-4d73-8818-eadaf12eaf37' then 'Compute'\n                 when dsd.app_id='980eea3c-b063-451e-8a45-ebcaa54fd561' then 'Storage'\n                 when dsd.app_id='f4cc7322-f1c0-4546-a06c-74e0c3894769' then 'Opsramp'\n                 when dsd.app_id='7cc837db-2045-4d58-a16f-b167bb9fd0d2' then 'UXI'\n                 when dsd.app_id is null then 'missing'\n                 else 'Others'\n             end as application_name\n      from active_sub as1\n      inner join device_sub_dim dsd on dsd.subscription_key=as1.subscription_key\n      inner join sm_device sd on sd.serial_number = dsd.serial_number\n      left join dsdefinedacct dda on as1.platform_customer_id=dda.platform_customer_id\n      left join customers_auth ca on ca.platform_customer_id = dda.platform_customer_id)\nSELECT *\nFROM active_dev\nWHERE if_test_workspace = 'non Test Workspace'\nAND is_active = TRUE;",
    "rating": "Bad",
    "timestamp": "2025-12-03T10:10:30.026756"
  }
]